<!DOCTYPE html>
<html>
<head>
  <title>Profile - CMRIT</title>
</head>
<body>
  <h2 id="welcome">Loading...</h2>
  <p id="info"></p>

  <script>
    const token = localStorage.getItem('token');
    if (!token) {
      document.getElementById('welcome').innerText = "Not logged in. Redirecting to login...";
      setTimeout(() => window.location.href = '/login', 2000);
    } else {
      fetch('/api/profile', {
        method: 'GET',
        headers: {
          'Authorization': token
        }
      })
      .then(res => res.json())
      .then(data => {
        if (data.message) {
          document.getElementById('welcome').innerText = data.message;
          document.getElementById('info').innerText = `Username: ${data.username}\nProfession: ${data.profession}`;
        } else {
          document.getElementById('welcome').innerText = "Invalid token. Please login again.";
          setTimeout(() => window.location.href = '/login', 2000);
        }
      });
    }
  </script>
</body>
</html>
