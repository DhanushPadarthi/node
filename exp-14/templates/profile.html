<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Profile</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
  <div class="container mt-5">
    <form id="findUserForm" class="d-flex mb-4 w-50 mx-auto">
      <input id="email" class="form-control me-2" placeholder="Search Email">
      <button class="btn btn-success" type="submit">Search</button>
    </form>

    <div id="ucard" class="card shadow-sm p-3 mx-auto w-50 d-none">
      <img class="mx-auto" width="200" height="200" src="https://cdn-icons-png.freepik.com/512/5733/5733290.png">
      <h2 id="greet" class="text-center">Hi, </h2>
      <table class="table table-bordered mt-3">
        <tr><th>USER ID</th><td id="uid"></td></tr>
        <tr><th>USERNAME</th><td id="uname"></td></tr>
        <tr><th>EMAIL</th><td id="umail"></td></tr>
        <tr><th>OCCUPATION</th><td id="uoccu"></td></tr>
      </table>
    </div>

    <div class="text-center mt-4">
      <h5 id="err" class="text-danger d-none">User Not Found</h5>
      <a href="/" class="btn btn-primary">BACK</a>
    </div>
  </div>

  <script>
    $(() => {
      $('#findUserForm').submit(e => {
        e.preventDefault();
        $('#ucard, #err').addClass('d-none');
        $.post('{% url "get" %}', JSON.stringify({ email: $('#email').val() }), data => {
          if (data.length) {
            $('#greet').text('Hi, ' + data[0].username);
            $('#uid').text(data[0].userid);
            $('#uname').text(data[0].username);
            $('#umail').text(data[0].email);
            $('#uoccu').text(data[0].occupation);
            $('#ucard').removeClass('d-none');
          } else $('#err').removeClass('d-none');
        }, 'json').fail(err => console.log(err));
      });
    });
  </script>
</body>
</html>
